# Cloudflare Pages 构建配置

## 正确的配置

在 Cloudflare Dashboard → Workers & Pages → 项目 → Settings → Builds & deployments 中：

### 必需配置

```
Build command: pnpm run build
Build output directory: .next
Root directory: / (或留空)
```

### ⚠️ 重要：Deploy Command

**Deploy command 字段必须留空或删除！**

当前错误配置：
```
Deploy command: npx wrangler deploy  ❌ 错误！
```

这会导致错误：
```
✘ [ERROR] It looks like you've run a Workers-specific command in a Pages project.
```

### 为什么不需要 Deploy Command？

Cloudflare Pages 会自动：
1. 运行 Build command
2. 将 Build output directory 的内容部署到全球边缘网络
3. 不需要额外的部署步骤

### wrangler.toml 的作用

`wrangler.toml` 文件用于配置：
- D1 数据库绑定
- KV 命名空间绑定
- 环境变量

但**不用于触发部署**。部署由 Cloudflare Pages 自动完成。

## 如何修复当前部署失败

1. 登录 Cloudflare Dashboard
2. 进入项目设置
3. 找到 Builds & deployments
4. **删除** Deploy command 字段的内容
5. 保存并重新部署

## 参考文档

- [Cloudflare Pages 文档](https://developers.cloudflare.com/pages/)
- [项目故障排除](deploy/cloudflare/TROUBLESHOOTING.md)
